# Функциональность выбора размеров товаров

## Обзор

Система выбора размеров позволяет пользователям выбирать размеры товаров перед добавлением в корзину. Выбранные размеры сохраняются в сессии и восстанавливаются при перезагрузке страницы.

## Компоненты системы

### 1. API для работы с размерами (`/api/size-selection.php`)

**Поддерживаемые действия:**

- `POST /api/size-selection.php` - Сохранение/получение/очистка выбранного размера
- `GET /api/size-selection.php` - Получение выбранных размеров

**Параметры POST запроса:**

```json
{
  "action": "select|get|clear",
  "productId": 123,
  "size": "M" // только для action="select"
}
```

**Ответы API:**

```json
// Успешное сохранение
{
  "success": true,
  "message": "Размер выбран",
  "productId": 123,
  "size": "M"
}

// Получение размера
{
  "success": true,
  "productId": 123,
  "selectedSize": "M"
}
```

### 2. JavaScript обработчик (`/js/size-handler.js`)

**Основные функции:**

- `saveSelectedSize(productId, size)` - Сохранение выбранного размера
- `getSelectedSize(productId)` - Получение сохраненного размера
- `restoreSelectedSizes()` - Восстановление всех выбранных размеров
- `addToCart(productId, size)` - Добавление товара в корзину

**Обработчики событий:**

- Клик по размеру - выбор размера и сохранение в сессии
- Клик по кнопке "Добавить в корзину" - валидация выбора размера

### 3. CSS стили (`/style/index.css`)

**Ключевые классы:**

- `.size-item` - кнопка размера
- `.size-item.active` - активный (выбранный) размер
- `.btn-add-to-cart` - кнопка добавления в корзину
- `.card-block-info` - блок с размерами и кнопкой

## Как использовать

### 1. В HTML структуре товара

```html
<div class="product-item">
  <div class="container-card">
    <div class="block-img">
      <img src="/img/product.jpg" alt="Товар" />
    </div>
    <div class="card-block-info">
      <div class="block-size">
        <button class="size-item">S</button>
        <button class="size-item">M</button>
        <button class="size-item">L</button>
      </div>
      <button class="btn-add-to-cart">Добавить в корзину</button>
    </div>
  </div>
  <div class="block-card-icon" data-product-id="123">
    <!-- иконка избранного -->
  </div>
  <h2 class="product-name">Название товара</h2>
  <p class="product-price">Цена: 1000 ₴</p>
</div>
```

### 2. Подключение JavaScript

```html
<script src="js/size-handler.js"></script>
```

### 3. Генерация размеров в PHP

```php
<?php
if (!empty($product['size'])) {
    $sizes = explode(',', $product['size']);
    foreach ($sizes as $size) {
        $size = trim($size);
        if (!empty($size)) {
            echo '<button class="size-item">' . htmlspecialchars($size) . '</button>';
        }
    }
} else {
    echo '<span style="color: #fff; font-size: 14px;">Размеры не указаны</span>';
}
?>
```

## Функциональность

### Выбор размера

1. Пользователь наводит курсор на изображение товара
2. Появляется блок с размерами и кнопкой "Добавить в корзину"
3. Пользователь кликает на нужный размер
4. Размер становится активным (зеленым) и сохраняется в сессии

### Добавление в корзину

1. Пользователь выбирает размер
2. Кликает "Добавить в корзину"
3. Система проверяет, выбран ли размер
4. Если размер выбран - товар добавляется в корзину с выбранным размером
5. Если размер не выбран - показывается предупреждение

### Сохранение состояния

- Выбранные размеры сохраняются в PHP сессии
- При перезагрузке страницы размеры автоматически восстанавливаются
- Каждый товар может иметь свой выбранный размер

## Визуальные эффекты

### Анимации

- Размеры появляются при наведении на изображение
- Выбранный размер увеличивается и получает тень
- Кнопка "Добавить в корзину" анимируется при наведении
- При добавлении в корзину кнопка меняет цвет на зеленый

### Состояния

- **Обычное**: белая рамка, прозрачный фон
- **При наведении**: зеленый фон
- **Активное**: зеленый фон, увеличенный размер, тень

## Интеграция с существующим кодом

Система выбора размеров интегрирована в:

- `find.php` - главная страница с товарами
- `templase/card-product.php` - шаблон карточки товара
- Существующую систему избранных товаров

## Расширение функциональности

### Добавление в корзину

Для полной интеграции с корзиной нужно:

1. Создать API для добавления товаров в корзину
2. Модифицировать функцию `addToCart()` в `size-handler.js`
3. Добавить обработку ответов от сервера

### Сохранение в базе данных

Для постоянного хранения выбранных размеров:

1. Создать таблицу `user_size_selections`
2. Модифицировать API для работы с БД
3. Добавить аутентификацию пользователей

## Отладка

### Консоль браузера

Откройте F12 и перейдите во вкладку Console для просмотра:

- Логов выбора размеров
- Ошибок API запросов
- Информации о добавлении в корзину

### API тестирование

Можно тестировать API напрямую:

```bash
# Сохранение размера
curl -X POST http://localhost/api/size-selection.php \
  -H "Content-Type: application/json" \
  -d '{"action":"select","productId":1,"size":"M"}'

# Получение размера
curl http://localhost/api/size-selection.php?productId=1
```
