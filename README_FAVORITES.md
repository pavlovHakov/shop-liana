# Функциональность "Избранное"

## Описание

Добавлена полная функциональность для работы с избранными товарами:

- Добавление товаров в избранное
- Удаление товаров из избранного
- Отображение списка избранных товаров
- Сохранение избранного по сессии пользователя

## Установка

### 1. Создание таблицы в базе данных

Выполните SQL-скрипт `create_favorites_table.sql` в вашей базе данных:

```sql
-- Создание таблицы для избранных товаров
CREATE TABLE IF NOT EXISTS favorites (
    id INT AUTO_INCREMENT PRIMARY KEY,
    productId INT NOT NULL,
    sessionId VARCHAR(255) NOT NULL,
    createdAt DATETIME DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (productId) REFERENCES product(id) ON DELETE CASCADE
);

-- Создание индекса для быстрого поиска по sessionId и productId
CREATE INDEX idx_favorites_session_product ON favorites(sessionId, productId);
```

### 2. Файлы, которые были созданы/обновлены:

#### Новые файлы:

- `api/favorites.php` - API endpoint для работы с избранным
- `create_favorites_table.sql` - SQL-скрипт для создания таблицы
- `README_FAVORITES.md` - данный файл с инструкциями

#### Обновленные файлы:

- `function/functions.php` - добавлены функции для работы с избранным
- `js/icon-favorite.js` - обновлен JavaScript для AJAX запросов
- `favorite.php` - полностью переработана страница избранного
- `style/favorite.css` - обновлены стили для страницы избранного
- `templase/card-product.php` - добавлен data-атрибут для ID товара
- `database.sql` - добавлена структура таблицы избранного

## Функциональность

### Добавление в избранное

- Клик по иконке сердца на карточке товара
- Товар сохраняется в базе данных по session ID
- Иконка меняет цвет на красный
- Показывается уведомление об успешном добавлении

### Удаление из избранного

- Клик по иконке сердца (если товар уже в избранном)
- Или кнопка "Удалить из избранного" на странице избранного
- Товар удаляется из базы данных
- Иконка возвращается к исходному цвету

### Страница избранного

- Отображает все избранные товары пользователя
- Красивый адаптивный дизайн
- Возможность перейти к товару или удалить его
- Сообщение, если избранное пустое

## API Endpoints

### POST /api/favorites.php

Добавление/удаление товара из избранного:

```json
{
  "action": "add|remove",
  "productId": 123
}
```

### GET /api/favorites.php?action=check&productId=123

Проверка, находится ли товар в избранном:

```json
{
  "isFavorite": true
}
```

### GET /api/favorites.php

Получение списка избранных товаров:

```json
{
    "favorites": [...]
}
```

## Особенности реализации

1. **Безопасность**: Используются подготовленные запросы для защиты от SQL-инъекций
2. **Сессии**: Избранное привязано к session ID пользователя
3. **AJAX**: Все операции выполняются без перезагрузки страницы
4. **Уведомления**: Показываются красивые уведомления о результатах операций
5. **Адаптивность**: Дизайн адаптируется под мобильные устройства

## Тестирование

1. Откройте главную страницу сайта
2. Кликните по иконке сердца на любом товаре
3. Проверьте, что иконка изменила цвет
4. Перейдите на страницу `/favorite.php`
5. Убедитесь, что товар отображается в списке
6. Попробуйте удалить товар из избранного

## Возможные улучшения

1. Добавить авторизацию пользователей
2. Сохранять избранное в localStorage как резервную копию
3. Добавить анимации при добавлении/удалении товаров
4. Реализовать синхронизацию избранного между устройствами
